<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en-GB"> <![endif]-->
<!--[if IE 7]>		<html class="no-js lt-ie9 lt-ie8" lang="en-GB"> <![endif]-->
<!--[if IE 8]>		<html class="no-js lt-ie9" lang="en-GB"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en-GB"> <!--<![endif]-->
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Faceted search: choosing good facet suggestions | FT Labs</title>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
	<script src="https://polyfill.webservices.ft.com/v2/polyfill.min.js"></script>
	<script src="../../../wp-content/themes/ftlabs-2016/main.js"></script>
	<link rel="stylesheet" type="text/css" media="all" href="../../../wp-content/themes/ftlabs-2016/style.css" />

	<link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="FT Labs &raquo; Feed" href="../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="FT Labs &raquo; Comments Feed" href="../../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="FT Labs &raquo; Faceted search: choosing good facet suggestions Comments Feed" href="feed/index.html" />
<link rel='stylesheet' id='prettify-css'  href='../../../wp-content/plugins/prettify-code-highlight/code.css%3Fver=4.6.4.css' type='text/css' media='all' />
<!-- This site uses the Google Analytics by Yoast plugin v5.4.6 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-32884353-1', 'labs.ft.com');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->
<link rel='https://api.w.org/' href='../../../wp-json/index.html' />
<link rel='prev' title='Thoughts on CSS transitions in Firefox' href='../../../index.html%3Fp=129.html' />
<link rel='next' title='Tips for better fragment navigation' href='../../../index.html%3Fp=170.html' />
<link rel="canonical" href="../../../index.html%3Fp=175.html" />
<link rel='shortlink' href='../../../index.html%3Fp=175.html' />
<link rel="alternate" type="application/json+oembed" href="../../../wp-json/oembed/1.0/embed%3Furl=http%253A%252F%252Flabs.ft.com%252F2010%252F11%252Ffaceted-search-choosing-good-facet-suggestions%252F" />
<link rel="alternate" type="text/xml+oembed" href="../../../wp-json/oembed/1.0/embed%3Furl=http%253A%252F%252Flabs.ft.com%252F2010%252F11%252Ffaceted-search-choosing-good-facet-suggestions%252F&amp;format=xml" />
</head>
<body class="single single-post postid-175 single-format-standard">
	<div class="app" ontouchstart="">
		<div class='container'>
			<div class='sidebar'>
				<div class='logo-wrap'>
					<a href='../../../index.html' class='logo'>
						<h1>FT Labs</h1>
					</a>
				</div>
				<nav>
					<ul id="menu-header-navigation" class="app-header_nav"><li id="menu-item-14082" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14082"><a href="../../../index.html">Home</a></li>
<li id="menu-item-14083" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-14083"><a href="../../../articles.1.html">Articles</a></li>
<li id="menu-item-14084" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14084"><a href="../../../jobs.1.html">Jobs</a></li>
<li id="menu-item-14085" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14085"><a href="../../../contact-us.1.html">Contact</a></li>
</ul>				</nav>
			</div>
			<main>
			<script> var page = 'article-view';
			</script>
				<article class="article_content body-text">
									<h1>Faceted search: choosing good facet suggestions</h1>
					<div class="date">by <a href="../../../author/andrew/index.html">Andrew Betts</a>, <time class="entry-date" datetime="2010-11-16T11:05:50+00:00" pubdate>16 November 2010</time></div>					<p><strong>This post was originally made on the Assanka blog.  Assanka was acquired by the Financial Times in January 2012, and became what is now FT Labs.  <a href="../../../index.html%3Fp=1901.html">Learn more</a>.</strong></p>
<p>Faceted search is everywhere, making our online shopping experience easier, organising our photos, searching our DVD collection.  By showing filters in categories, you can allow users to search the way they want to, rather than in a prescribed category hierarchy of your choice.  We&#8217;ve recently used faceted search in a number of applications and found that one area is a particular challenge: choosing the suggested values under each category.</p>
<figure id="attachment_2427" class="wp-caption alignnone"><img alt='FT Tilt's faceting uses a blend of strategies' src="https://image.webservices.ft.com/v1/images/raw/http://ftlabs.wpengine.com/wp-content/uploads/2010/11/moodys.png" width="515" class="size-full wp-image-2427" srcset="../../../wp-content/uploads/2010/11/moodys.png 515w, ../../../wp-content/uploads/2010/11/moodys-300x178.png%3Fsource=ftlabs 300w" sizes="(max-width: 515px) 100vw, 515px" /><figcaption class="wp-caption-text">The site Assanka recently launched for <a href="http://tilt.ft.com">FT Tilt</a> uses a variety of faceting strategies to give the most appropriate suggestions in each category</figcaption></figure>
<p>Most implementations of faceting always show the same suggestions in any given category, but may change the filters available based on the search the user has done so far.  For example, if you&#8217;re searching a computer supplies retailer for a new hard disk, most of the products matching your search will have a &#8216;capacity&#8217; property, so the retailer will probably offer you a capacity filter with all available capacities listed.  It probably won&#8217;t offer you a &#8216;pages per minute&#8217; filter, because resolution is not relevant to hard disks, and your existing search keywords have probably eliminated any product (like a monitor) for which a resolution choice would make sense.</p>
<p>So it&#8217;s pretty easy to choose which filters to display.  The more difficult problem is choosing which facets to display within each filter.</p>
<p>Sometimes it&#8217;s impractical to show all possible facets in a filter.  eBay, for example, allows you to restrict your search by seller, and of course there are millions of those.  So there are a number of possible strategies:</p>
<ol>
<li>Display every option available</li>
<li>Display just a few hard coded options, such as aggregate options designed to always match something (eg eBay&#8217;s &#8216;Top rated sellers&#8217; option), or editorially chosen &#8216;top picks&#8217;.  Either way, the point is that the suggestions are a subset of the full range available, and are not sensitive to the context created by the user&#8217;s search query</li>
<li>Use the list of options as per (1) or (2), but hide any that, if selected, would produce no results.  This refinement makes the suggestions context-sensitive in a very rudimentary way, in that they are at least reacting to the current state of the user&#8217;s search, but still do not surface any long-tail options when they become more relevant.</li>
<li>Generate options based on running the query the user has put together so far, including any facets selected, and analysing the resultset for the top facet refinements in each filter category.</li>
<li>As per (4), but for each filter category, run the search excluding any options already selected in that category.</li>
<li>As per (4) or (5), but where the values are all numeric, determine the facets not from the frequency of occurrence of specific values, but by analysing the distribution of values within the resultset and constructing boundaries that provide a sensible number of divisions with approximately the same number of results in each division.</li>
</ol>
<p>There are arguments for and against all of these, depending on the distribution of the metadata within your document index.</p>
<p>An e-commerce site will typically have a set of properties on a product, where each property has one value, and won&#8217;t use all the available property names.  The values available for each property will also typically be a range set, and will efficiently cover the whole available range.  For example a hard disk will have a &#8216;capacity&#8217; property, where the options might include 200GB, 300GB, 500GB and 1TB.  Only one of these can apply to any given hard disk.  A hard disk, as previously discussed, will also not make use of other available properties, such as resolution, that might apply to other types of product, such as monitors.  A property like &#8216;pages per minute&#8217; is really only going to be used on a very small subset of your product catalogue (only printers).  &#8216;Capacity&#8217; might get a bit more limelight as it applies to USB sticks, RAM and storage appliances as well as hard disks (though consider that the option values required in these types of products might be in a different range), and some properties like &#8216;manufacturer&#8217; would apply to virtually the entire product catalogue.</p>
<p>Sometimes, a product might have more than one applicable value in the same category.  Take an example category &#8220;Special offers available&#8221;.  A single product might qualify for &#8220;Buy one get one free&#8221; as well as &#8220;Free delivery&#8221;.   This kind of thing actually happens more in the non-retail world, and a better example would be a film library, where a film may have more than one actor, more than one screenwriter, more than one content advisory.  Where this is the case, filtering on one actor does not necessarily mean you&#8217;ve excluded all the others from the resultset.</p>
<p>The distribution is also relevant.  In the &#8216;capacity&#8217; example, we could expand the number of values to include more granularity below 50GB to allow for solid state devices, and above 1TB to allow for storage appliances, but in any given search, results will tend to form an unequal distribution with a peak, or multiple peaks, in particular capacities.  Across a range of hard disks, at time of writing 100-500GB would likely be the most popular value.  On the other hand take a category like &#8216;Actor&#8217; in the case of a film library, and the distribution looks a lot flatter.  An actor can only do so many films, and there are a lot of actors, so there isn&#8217;t a strong head to this distribution &#8211; it&#8217;s all tail.</p>
<p>Looking at each filter category in turn, the logic for deciding how to choose suggested values therefore comes down to a number of questions about how the category is used to classify your content:</p>
<ol>
<li>Are there few enough values that you could display them all together?</li>
<li>Do the values form a continuous range (like capacity) or are they discrete options (like actor)?</li>
<li>Is it possible for any single item of content to have more than one value from the same category?</li>
<li>Is there a &#8216;head&#8217; of a few values (few enough to display all of them together) which, combined, apply to a majority of your content?</li>
</ol>
<p>It&#8217;s important to stress that these are not decisions to take for your site as a whole &#8211; they need to be applied to each filter category individually.</p>
<p>There is one final consideration.  Is your faceting feature intended to help users narrow their search, change it, or broaden it?</p>
<p>Going back to the possible strategies for determining facets, displaying every option available works for small categories, and using hard coded options groups like &#8216;top 100 sellers&#8217; is basically a solution for displaying every option available by consolidating many options into one.  Doing this where necessary (and then also hiding any options that would result in no matches) gives you about the best solution you are likely to get without going context sensitive.</p>
<p><figure><img alt='Amazon BBFC ratings' src="https://image.webservices.ft.com/v1/images/raw/http://ftlabs.wpengine.com/wp-content/uploads/2010/11/Capture1.png?source=ftlabs" width="210" class="alignnone size-full wp-image-2426" /></figure></p>
<p><cite>The DVD search on <a href="http://www.amazon.co.uk" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.amazon.co.uk', 'Amazon.co.uk');">Amazon.co.uk</a> displays all possible options in the BBFC rating category, and hides any that don&#8217;t apply to the results.  In this case, the results found by the search only contain films rated PG, 15 and 12.</cite></p>
<p>It starts to get interesting when you have a lot of possible values, in a flattish distribution, and want to present specific, context sensitive options.  The sense of &#8216;context&#8217; depends on whether you want to help broaden or narrow the search.  </p>
<p>Take a search for the location &#8220;UK&#8221; and animal &#8220;Dog&#8221;, which will give you results referring to dogs in the UK.  One of the facet categories might be location, in which there is one option that is already a term in the search &#8211; UK.  Determining the facets to suggest in the location category by only looking at the results returned in the existing search would only yield locations that co-exist on items tagged with UK and dogs, so your filter refinements would be places like &#8220;Manchester&#8221;, &#8220;Birmingham&#8221;, &#8220;Liverpool&#8221;, &#8220;London&#8221;, &#8220;Cardiff&#8221;, &#8220;Edinburgh&#8221;.  This helps the searcher to refine their search.</p>
<p><figure><img alt='Lovefilm's search facets offer refinement' src="https://image.webservices.ft.com/v1/images/raw/http://ftlabs.wpengine.com/wp-content/uploads/2010/11/Capture.png" width="423" class="alignnone size-full wp-image-2425" srcset="../../../wp-content/uploads/2010/11/Capture.png 423w, ../../../wp-content/uploads/2010/11/Capture-300x121.png%3Fsource=ftlabs 300w" sizes="(max-width: 423px) 100vw, 423px" /></figure></p>
<p><cite>The film search on <a href="http://www.lovefilm.com" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.lovefilm.com', 'Lovefilm');">Lovefilm</a> presents facets that narrow your search.  It also arranges the facets in a hierarchy, though this is an illusion</cite></p>
<p>However, using strategy 5, you run the search once on &#8220;UK Dogs&#8221; to produce the results to show the user, but you run it again on &#8220;Dogs&#8221;, excluding the term from the locations category, to generate location facets.  This time you get locations globally that co-exist with Dogs, and the suggestions for facets in any given category do not change if you choose to add a facet from that category to your search.  In this case the suggestions would be more likely to be &#8220;Paris&#8221;, &#8220;New York&#8221;, &#8220;France&#8221;, &#8220;Boston&#8221;, &#8220;London&#8221;, &#8220;United States&#8221;.  This helps to broaden the search by showing the user good suggestions for other locations that also have lots of dogs that they may not have considered.</p>
<p>Finally, where the values are numeric, it may be appropriate to produce dynamic facets as range boundaries, based on an analysis of the values that exist within the resultset.  You still follow one or other of the above strategies to get a resultset that either narrows or broadens the search, but then analyse the list of values and construct divisions that evenly partition the data into a small number of ranges.  Doing this with a search for say the product type &#8220;Hard disks&#8221; and the capacity &#8220;100-150GB&#8221;, the suggested capacity facets would subdivide the selected range, with narrow boundaries covering the most popular capacities, and wider ranges where there are fewer results.</p>
<p><figure><img alt='Ebuyer's faceting of numeric categories is inconsistent' src="https://image.webservices.ft.com/v1/images/raw/http://ftlabs.wpengine.com/wp-content/uploads/2010/11/facet1.png" width="391" class="alignnone size-full wp-image-2424" srcset="../../../wp-content/uploads/2010/11/facet1.png 391w, ../../../wp-content/uploads/2010/11/facet1-300x144.png%3Fsource=ftlabs 300w" sizes="(max-width: 391px) 100vw, 391px" /></figure></p>
<p><cite><a href="http://www.ebuyer.com" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.ebuyer.com', 'Ebuyer&#8217;s');">Ebuyer&#8217;s</a> product search contains lots of faceting of numeric categories, some of which are presented in dynamic ranges, and some are treated as standard terms</cite></p>
<p>For numeric categories like this, it&#8217;s also worth considering the sort order of the facet list.  For categories of non-numeric values and sometimes even for discrete numeric values (say &#8216;film speed&#8217; or &#8216;quantity per box&#8217;), it&#8217;s generally best to present them in decreasing order of popularity within the search context you&#8217;ve chosen.   For numeric categories where you&#8217;re constructing range facets (eg. &#8216;capacity&#8217;, &#8216;pixel density&#8217;, &#8216;brightness&#8217;), they should instead be presented in value order.</p>
<h2>Conclusion</h2>
<p>There are many ways of faceting search results.  Take some time to choose the one that suits your application best, and provides the best search experience for your users.  We use the open source search engine <a href="http://www.xapian.org" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.xapian.org', 'Xapian');">Xapian</a>, which is excellent at doing all the faceting described in this post, and I&#8217;d like to publicly acknowledge <a href="http://cnav.co.uk/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://cnav.co.uk/', 'Richard Boulton');">Richard Boulton</a> for his excellent advice when we were designing faceting strategy for FT Tilt.</p>
									</article>
				<div id='comments'></div>
						</main>
		</div>
		<footer class="o-footer o-footer--theme-light" id="footer">
			<div class="o-footer__row o-footer__copyright">
				<div class="o-footer__col o-footer__col--full-width">
					<span>© THE FINANCIAL TIMES LTD 2016.</span>
					<span><abbr title="Financial Times">FT</abbr> and ‘Financial Times’ are trademarks of The Financial Times Ltd.</span>
				</div>
			</div>
			<div class="o-footer__pearson">
				<div class="o-footer__row">
					<div class="o-footer__col o-footer__col--full-width">
						<div class="o-footer__pearson-tagline" aria-label="Always Learning"></div>
						<div class="o-footer__pearson-logo" aria-label="Pearson"></div>
					</div>
				</div>
			</div>
		</footer>
	</div>
	<script>window.onload = function() { prettyPrint(); }</script><script type='text/javascript' src='http://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js?ver=4.6.4'></script>
<script type='text/javascript' src='../../../wp-includes/js/wp-embed.min.js%3Fver=4.6.4'></script>
		<!--
	JIRA Issue collector seems v unreliable
	<script type="text/javascript" src="https://jira.ft.com/s/522ea8c716f027c1d18693d0cb29a056-T/en_UK-7dt5dq/64016/3/1.4.25/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&amp;collectorId=eb5e21bf"></script>-->
</body>
</html>
