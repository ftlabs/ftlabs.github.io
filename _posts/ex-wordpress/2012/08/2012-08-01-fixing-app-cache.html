---
layout: wp-post
title: 'Fixing app cache'
date: 2012-08-01
categories: [ex-wordpress]
permalink: /2012/08/fixing-app-cache/
author: andrew
---
<p>At FT Labs, we are on a mission to fix <a href="https://developer.mozilla.org/en-US/docs/HTML/Using_the_application_cache" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://developer.mozilla.org/en-US/docs/HTML/Using_the_application_cache', 'app cache');">app cache</a>, for the good of <del>mankind</del> web developers.</p>
<p>Over the last few weeks a couple of important meetings have taken place bringing together developers and browser vendors to try and work out what went wrong and how we can fix an oft-reviled godawful mess that is the HTML5 application cache.  We hosted a meeting of a number of developers and browser vendors here in London on the 14th of August, and Mozilla hosted a meeting on the 24th at their office in Mountain View in Silicon Valley.</p>
<p>At the FT Labs event, the aim was first to air our practical experiences with sites that the developers present were building &#8211; <a href="http://www.facebook.com" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.facebook.com', 'Facebook');">Facebook</a>, <a href="http://www.gmail.com" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.gmail.com', 'GMail');">GMail</a>, the <a href="http://app.ft.com">FT</a> and <a href="http://app.economist.com" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://app.economist.com', 'Economist ');">Economist </a> HTML5 apps and <a href="http://m.lanyrd.com" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://m.lanyrd.com', 'Lanyrd');">Lanyrd</a>.  It was great to explore the techniques that are being used, and the solutions that developers are trying to achieve.  Google, for example, wants not only to update individual files in cache but to apply differential updates so that only new parts of a file are downloaded.  That might sound nuts but it was one of a long list of things throughout the day that followed the same pattern &#8211; we want to do this on the web, and despite the fact that web standards are a million miles away from supporting us in our objective, we want it because it makes for a better app.  And of course you can do it with a native app, yada yada.</p>
<p>For our part, we want to be able to cache media content &#8211; audio and video, individually, in some kind of storage that doesn&#8217;t require us to do crazy stuff just to make efficient use of the meagre quotas we have available.  We want better control over what is cached and what isn&#8217;t, knowledge of whether we got served from cache or not, and we want to be able to ask for more quota.  MUCH more.  No standard tells a browser vendor how much storage they must allow a website to request, so it varies from unusably small to unlimited.</p>
<p>All these complaints came out and gave us a great wealth of shared experience to draw a better mental model of what is wrong with app cache.  But the biggest realisation of all was that none of us actually understands it.  A roomful of some of the smartest developers and browser makers on the planet, allowing an entire day to do so, cannot wrap their heads around the damn thing.  We had no common understanding of either the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#the-application-cache-selection-algorithm" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#the-application-cache-selection-algorithm', 'app cache selection algorithm');">app cache selection algorithm</a> or the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#application-cache-download-process" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#application-cache-download-process', 'app cache download process');">app cache download process</a>.</p>
<p>So we started to use what we do know &#8211; the things we wanted to do and couldn&#8217;t &#8211; to build up a set of user stories that could feed back into the spec process and hopefully fix app cache for everyone.  </p>
<p>Mozilla&#8217;s meeting over in California added some more experiences &#8211; <a href="http://m.twitter.com" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://m.twitter.com', 'Twitter');">Twitter</a>, and Microsoft Outlook Web Access particularly, and drew out a number of high level ideas for what a fixed Appcache could look like.  It&#8217;s a view I like a lot, particularly these points:</p>
<ul>
<li>Get rid of master entries concept</li>
<li>When navigating, look for an appcache which contains that URL, rather than look for an appcache which has that URL as master entry.</li>
<li>JS-API for adding/removing/enumerating entries</li>
<li>JS-API for creating/deleting/enumerating appcaches</li>
<li>Knowing if you&#8217;re being served from appcache or not. And which version of the appcache.</li>
<li>Ability to write a HTTP server in JS which handle URI spaces.</li>
<li>Network:* should be default mode</li>
</ul>
<p>The work continues.  We&#8217;ve formed a new <a href="http://www.w3.org/community/fixing-appcache/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.w3.org/community/fixing-appcache/', 'W3C community group called &#8216;Fixing appcache&#8217;');">W3C community group called &#8216;Fixing appcache&#8217;</a>, which Tobie and I are chairing, to move the process forwards, and many of the participants from these two gatherings are members.  The notes from the London (<a href="https://etherpad.mozilla.org/appcache-london" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://etherpad.mozilla.org/appcache-london', 'as it happened');">as it happened</a> and <a href="http://www.w3.org/community/fixing-appcache/wiki/Meeting_notes_14_August_2012" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.w3.org/community/fixing-appcache/wiki/Meeting_notes_14_August_2012', 'more refined');">more refined</a>) and Mountain View (<a href="https://etherpad.mozilla.org/appcache" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://etherpad.mozilla.org/appcache', 'as it happened');">as it happened</a>) meetings are available online, so if you&#8217;re interested in helping out, go and read them, <a href="http://www.w3.org/community/fixing-appcache/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.w3.org/community/fixing-appcache/', 'join the group');">join the group</a>, help us refine the use cases.  Share your own experiences with app cache.</p>
<p>Together, we can fix appcache.  Then we&#8217;ll do the world peace thing.</p>
