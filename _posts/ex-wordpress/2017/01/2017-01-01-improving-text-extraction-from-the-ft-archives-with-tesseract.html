---
layout: wp-post
title: Improving text extraction from the FT Archives with Tesseract
date: 2017-01-01
categories: [ex-wordpress]
permalink: /2017/01/improving-text-extraction-from-the-ft-archives-with-tesseract
---
<p>We have an online archive, currently only available in-house, of all printed issues of the Financial Times newspaper, from the first issue in <a href="http://aboutus.ft.com/files/2010/09/FThistory.jpg" target="_blank">1888 through to 2010</a>. Each page of each issue has been photographed, divided into distinct articles, and each article has been processed with OCR (<a href="https://en.wikipedia.org/wiki/Optical_character_recognition" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://en.wikipedia.org/wiki/Optical_character_recognition', 'Optical Character Recognition');" target="_blank">Optical Character Recognition</a>) to extract the source text from the image. </p>
<p>The archive weighs in at approximately 2 TB of JPGs (one for each page of each issue) and XML (one monster file per issue, containing the positional data and titles of each article, and the text fragments identified within each article).</p>
<p>As we consider how to integrate the content of our archive into the main site, <a href="https://open.blogs.nytimes.com/2016/07/26/the-future-of-the-past-modernizing-the-new-york-times-archive" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://open.blogs.nytimes.com/2016/07/26/the-future-of-the-past-modernizing-the-new-york-times-archive', 'as others have done');" target="_blank">as others have done</a>, one significant step is to improve the OCR: the extracted text varies from almost perfect transcription to random noise.</p>
<p>We used open-source software, <a href="https://github.com/tesseract-ocr" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/tesseract-ocr', 'Tesseract');" target="_blank">Tesseract</a>, with its default settings, to achieve a very gratifying improvement in OCR quality.<br />
<span id="more-14291"></span></p>
<p><a href="../../../wp-content/uploads/2017/01/DarkOCR1.png"><img alt='Image of article - original OCR scan - Tesseract default scan ' src="/wp-content/uploads/2017/01/DarkOCR1.png" width="2000" class="size-full wp-image-14293" srcset="../../../wp-content/uploads/2017/01/DarkOCR1.png 2000w, ../../../wp-content/uploads/2017/01/DarkOCR1-300x180.png 300w, ../../../wp-content/uploads/2017/01/DarkOCR1-768x461.png 768w, ../../../wp-content/uploads/2017/01/DarkOCR1-1024x614.png 1024w" sizes="(max-width: 2000px) 100vw, 2000px" /></a></p>
<p>On the left, we have an article which has been cropped from its parent page according to the coordinates stored in the XML. In the middle, we have the original OCR text that we received from the 3rd party. And on the right we have the results of a default OCR scan from Tesseract. It&#8217;s not perfect, but it&#8217;s rather good for an off-the-shelf piece of kit. And what&#8217;s even more impressive is that Tesseract correctly identified a 55 year old spelling error!</p>
<p>We continued with Tesseract to make further OCR improvements, described in a later post, but the remainder of this post describes how we used the out-of-the-box version to make the first big improvement. These posts are based on notes from a <a href="https://twitter.com/MobliMic/status/797456559043411968" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://twitter.com/MobliMic/status/797456559043411968', 'presentation');" target="_blank">presentation</a> given at <a href="https://twitter.com/BarcampSouth" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://twitter.com/BarcampSouth', 'Barcamp Southampton');" target="_blank">Barcamp Southampton</a>.</p>
<h2>The problem: inconsistent OCR quality</h2>
<p>The problem we have here, is that the archived page image quality has changed over time. The settings that create the ideal circumstance for OCR aren&#8217;t constant across the entirety of our dataset. This is unfortunate, but the 3rd party company we engaged was hardly going to manually dial in the OCR settings for each and every one of the individual issues.</p>
<p>One thing to note is that although the general quality of the page images varies across the century, each decade is largely consistent within itself. The clarity and level of detail in the images from a January 1960 edition is roughly equivalent to the images from a December 1969 edition. That said, the images are quite noisy, often misaligned, sometimes with movement-induced discontinuities across the middle of a page. However, the bigger problem isn&#8217;t so much <em>&#8220;Can we scan the entire page or entire issue in one pass&#8221;</em> but more <em>&#8220;Can we scan decades of issues without too much configuration and with a reasonable result. Also we&#8217;ve changed fonts across the decades! Oh, the paper, ink, and printing machinery also varies.&#8221;</em></p>
<h2>The opportunity: good positional data and Tesseract</h2>
<p>The initial OCR content was not particularly high quality, BUT the data in the XML files describing the location of that content was both comprehensive and accurate. This meant that we could use the XML files to re-run OCR on the images on an article-by-article basis.</p>
<figure id="attachment_14288" class="wp-caption aligncenter"><a href="../../../wp-content/uploads/2017/01/Screen-Shot-2017-01-18-at-15.38.01.png"><img alt='individual page components and articles highlighted, based on the XML data' src="/wp-content/uploads/2017/01/Screen-Shot-2017-01-18-at-15.38.01.png" width="1420" class="size-full wp-image-14288" srcset="../../../wp-content/uploads/2017/01/Screen-Shot-2017-01-18-at-15.38.01.png 1420w, ../../../wp-content/uploads/2017/01/Screen-Shot-2017-01-18-at-15.38.01-300x215.png 300w, ../../../wp-content/uploads/2017/01/Screen-Shot-2017-01-18-at-15.38.01-768x551.png 768w, ../../../wp-content/uploads/2017/01/Screen-Shot-2017-01-18-at-15.38.01-1024x734.png 1024w" sizes="(max-width: 1420px) 100vw, 1420px" /></a><figcaption class="wp-caption-text">individual page components and articles highlighted, based on the XML data</figcaption></figure>
<p>Plus, there was Tesseract, a piece of open-source software that&#8217;s really good at one thing &#8211; OCR scanning.</p>
<p>We picked a few articles at random from across the decades and ran Tesseract with its default settings, and got the spectacular results above.</p>
<p>To be slightly fairer to the original provider of our OCR, here is another, more typical improvement in OCR</p>
<p><a href="../../../wp-content/uploads/2017/01/DarkOCR2.png"><img alt='DarkOCR2' src="/wp-content/uploads/2017/01/DarkOCR2.png" width="2040" class="aligncenter size-full wp-image-14292" srcset="../../../wp-content/uploads/2017/01/DarkOCR2.png 2040w, ../../../wp-content/uploads/2017/01/DarkOCR2-300x176.png 300w, ../../../wp-content/uploads/2017/01/DarkOCR2-768x452.png 768w, ../../../wp-content/uploads/2017/01/DarkOCR2-1024x602.png 1024w" sizes="(max-width: 2040px) 100vw, 2040px" /></a></p>
<p>The improvement brought about by using Tesseract is sufficient to justify re-doing the OCR across the entire archive but, even so, there are still sections of the archive which remain illegible (for our OCR). </p>
<h2>Gotchas</h2>
<p>There are several challenges we noted but parked for the duration of this project</p>
<ul>
<li>Combining articles which are split across columns or pages</li>
<li>Identifying adverts (rather than journalistic copy)</li>
<li>Handling tabular text</li>
</ul>
